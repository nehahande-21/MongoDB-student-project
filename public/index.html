<!DOCTYPE html>
<html>
<head>
  <title>Student Management System</title>
</head>
<body>

<h1>Student Management System</h1>

<h3>Add Student</h3>
<input id="studentId" placeholder="Student ID"><br>
<input id="name" placeholder="Name"><br>
<input id="department" placeholder="Department"><br>
<input id="semester" placeholder="Semester"><br>
<input id="subjects" placeholder="Subjects (comma separated)"><br>
<input id="attendance" placeholder="Attendance"><br>

<button type="button" onclick="addStudent()">Add</button>

<h3>Students List</h3>
<ul id="students"></ul>

<script>
async function loadStudents() {
  const res = await fetch("/students");
  const students = await res.json();

  const list = document.getElementById("students");
  list.innerHTML = "";

  students.forEach(s => {
    const li = document.createElement("li");
    li.innerHTML = `
      ${s.studentId} - ${s.name} (${s.department})
      <button onclick="deleteStudent('${s.studentId}')">Delete</button>
    `;
    list.appendChild(li);
  });
}

async function addStudent() {
  const student = {
    studentId: document.getElementById("studentId").value,
    name: document.getElementById("name").value,
    department: document.getElementById("department").value,
    semester: Number(document.getElementById("semester").value),
    subjects: document.getElementById("subjects").value.split(","),
    attendance: Number(document.getElementById("attendance").value)
  };

  await fetch("/add", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(student)
  });

  loadStudents();
}

async function deleteStudent(id) {
  await fetch(`/delete/${id}`, { method: "DELETE" });
  loadStudents();
}

loadStudents();
</script>

</body>
</html>
